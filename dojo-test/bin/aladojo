#!/usr/bin/env node

// core
var path = require("path"),
    
// dojo
    common = require(path.join(__dirname, '..', 'common.js')),
    Suite = require(path.join(__dirname, '..', 'test.js'));

var getopt = common.getopt(process.argv);
var argv = getopt.argv;
var opt = getopt.opt;

if (opt.nocolors || opt.nc) {
    common.colors.mode = "none";
}

var file;
if (argv.length == 0) {
    file = path.resolve("tests", "suite.js");
} else {
    file = path.resolve(argv[0]);
}
var name = opt.name || opt.n || path.basename(file).replace(/\.js$/, '');
var suite;
try {
    suite = require(file); // may be a runner on it's own, returning {}
} catch (e) {
    process.stderr.write(Suite.banner());
    common.fail("File not found: "+file, "test");
}
if (Object.keys(suite).length > 0) {
    Suite.run(suite, name);
}
